from liblan.dmet import ssdmet
from pyscf import gto, scf

mol = gto.M(atom='''
        Co    7.745224   10.590665    4.249971
        Cl    9.313926   10.245432    5.842795
        N1    7.924888   10.341691    2.239454
        N1    7.018889   12.443048    4.128819
        N1    5.958917    9.665454    4.356619
        N    8.887307    9.809745    0.143085
        N    9.312329    8.492870    1.986836
        N    6.806059   14.702899    4.768406
        N    8.899839   13.755245    4.461022
        N    4.578421    7.825906    4.878077
        N    5.481923    9.157058    6.565570
        C    4.439707   11.630145    1.491583
        H    4.629897   12.494159    1.068981
        H    3.604015   11.692666    1.999314
        H    4.351336   10.940679    0.800003
        C    5.588080   11.260153    2.439801
        C    6.868134   11.150382    1.586280
        H    6.640946   10.740172    0.714041
        H    7.219572   12.059135    1.411444
        C    8.688904    9.589448    1.473974
        C    9.000629    8.720410   -0.823157
        H    8.853553    7.864553   -0.368806
        H    9.895878    8.728784   -1.221495
        H    8.329310    8.837094   -1.526522
        C    9.087351   11.142866   -0.407350
        H    8.992813   11.807935    0.306414
        H    8.419394   11.312942   -1.103644
        H    9.986171   11.205160   -0.794457
        C   10.674168    8.155979    1.612900
        H   10.913227    8.629316    0.788911
        H   10.743506    7.189602    1.466903
        H   11.286183    8.422635    2.330685
        C    8.839009    7.855708    3.205835
        H    7.916551    8.134476    3.383028
        H    9.410623    8.120754    3.955647
        H    8.871376    6.882153    3.098798
        C    5.692821   12.401614    3.486460
        H    5.519137   13.268088    3.040566
        H    4.998684   12.271333    4.180258
        C    7.551475   13.605601    4.447573
        C    5.557915   14.593940    5.502135
        H    5.371133   13.651052    5.691529
        H    4.829518   14.969816    4.965010
        H    5.630249   15.088373    6.345951
        C    7.207116   16.063835    4.411663
        H    8.054248   16.036755    3.920985
        H    7.318523   16.595932    5.227056
        H    6.515880   16.471279    3.848888
        C    9.591027   14.572748    5.453053
        H    8.932784   15.066002    5.986851
        H   10.183620   15.207486    4.998286
        H   10.120445   13.994629    6.040924
        C    9.783258   12.975046    3.606391
        H    9.247623   12.450962    2.974014
        H   10.321849   12.370408    4.158074
        H   10.375885   13.578868    3.111277
        C    5.236263    9.891754    3.085211
        H    4.261929    9.854297    3.255471
        H    5.462135    9.166485    2.449922
        C    5.364879    8.886773    5.246189
        C    4.997035    6.910932    3.821297
        H    5.814322    7.250525    3.399666
        H    4.287129    6.840768    3.148712
        H    5.172227    6.026917    4.205215
        C    3.375469    7.435361    5.595307
        H    3.172637    8.105093    6.280786
        H    3.517607    6.564452    6.021513
        H    2.625806    7.373322    4.966396
        C    5.880053   10.483630    7.027270
        H    5.478126   10.658560    7.904362
        H    5.572479   11.158428    6.386159
        H    6.856148   10.524406    7.101586
        C    5.390381    8.150740    7.621796
        H    5.412120    8.592719    8.496392
        H    6.147670    7.532270    7.549421
        H    4.552004    7.653271    7.527238
        ''',
        basis={'default':'def2tzvp','C':'6-31G*','H':'6-31G*','N':'6-31G*'}, symmetry=0 ,spin = 3,charge = +1,verbose= 4)

title = 'CoL4'
mf = scf.rohf.ROHF(mol).x2c()
mf.chkfile = title+'_rohf.chk'
mf.init_guess = 'chk'
mf.level_shift = .2
mf.max_cycle = 1
mf.kernel()

mydmet = ssdmet.SSDMET(mf,title=title)

mydmet.kernel(mol.search_ao_label('Co *'),imp_solver='casscf',imp_solver_soc='siso',statelis=[0,35,0,10])