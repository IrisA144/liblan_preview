from liblan.dmet import ssdmet
from pyscf import gto, scf

mol = gto.M(atom='''
                Fe    3.440601    2.534199    2.224653
                C1    1.941701    3.983918    3.096269
                C1    3.058404    4.753542    2.623926
                C1    3.156851    4.560230    1.206086
                C1    2.077526    3.706758    0.790886
                C1    1.332957    3.339102    1.967995
                C    1.393296    3.941511    4.509854
                H    0.665187    3.256099    4.502560
                C    2.397449    3.478408    5.563356
                H    2.742658    2.594005    5.319180
                H    1.955241    3.427663    6.435702
                H    3.139728    4.116337    5.610975
                C    0.724347    5.264852    4.902764
                H    1.409175    5.956426    5.013201
                H    0.238941    5.148140    5.744714
                H    0.097833    5.535972    4.198606
                C    3.787716    5.806005    3.451489
                H    3.407328    5.743783    4.374899
                C    5.295924    5.675157    3.609545
                H    5.500444    4.877503    4.139842
                H    5.646133    6.468702    4.064867
                H    5.711609    5.595174    2.725447
                C    3.418697    7.216095    2.932743
                H    3.757514    7.891962    3.556252
                H    2.444302    7.293903    2.863239
                H    3.820635    7.355521    2.050671
                C    4.203836    5.175808    0.298685
                H    4.848384    5.645918    0.901728
                C    5.025766    4.116337   -0.453498
                H    5.434295    3.501363    0.190477
                H    5.728657    4.557330   -0.974676
                H    4.438493    3.614934   -1.055731
                C    3.650815    6.248448   -0.646610
                H    3.140891    5.818691   -1.365763
                H    4.393885    6.757463   -1.033441
                H    3.064736    6.854119   -0.145898
                C    1.663233    3.488919   -0.657147
                H    2.377628    3.920609   -1.207707
                C    1.578741    2.054544   -1.154211
                H    2.470905    1.649193   -1.134758
                H    1.236279    2.046691   -2.072961
                H    0.974180    1.544080   -0.575485
                C    0.375084    4.271953   -0.967989
                H   -0.376437    3.869865   -0.484299
                H    0.197254    4.239574   -1.931116
                H    0.483230    5.204925   -0.686934
                C    0.044130    2.541811    1.968603
                H   -0.122153    2.283498    1.017230
                C    0.093202    1.233935    2.760097
                H    0.865796    0.705589    2.470126
                H   -0.728632    0.724920    2.601839
                H    0.173659    1.432925    3.716334
                C   -1.163247    3.396975    2.395354
                H   -1.137695    3.537610    3.365775
                H   -1.993446    2.934718    2.154015
                H   -1.127961    4.263738    1.939221
                C1    4.564852    0.876066    2.623926
                C    5.521312    0.836558    3.663851
                C    6.168305   -0.350257    3.995566
                H    6.799269   -0.357627    4.705195
                C    5.903710   -1.516895    3.304984
                H    6.341363   -2.325785    3.544094
                C    4.995732   -1.495872    2.262627
                H    4.820629   -2.293163    1.775086
                C    4.337261   -0.324281    1.919768
                C    5.913123    2.103839    4.391920
                H    5.224230    2.795775    4.176316
                C    7.256643    2.618532    3.867500
                H    7.958330    1.965741    4.072972
                H    7.468553    3.473575    4.297898
                H    7.201330    2.745030    2.897687
                C    5.956566    1.961633    5.910471
                H    5.100578    1.606906    6.229013
                H    6.118290    2.839270    6.316146
                H    6.678526    1.348351    6.160117
                C    3.389304   -0.355332    0.740227
                H    2.916441    0.525567    0.717329
                C    4.145669   -0.495362   -0.576700
                H    4.753993    0.265804   -0.686934
                H    3.506333   -0.513485   -1.319157
                H    4.662217   -1.327812   -0.569406
                C    2.324571   -1.436671    0.860187
                H    2.743596   -2.318536    0.778120
                H    1.661884   -1.322979    0.147924
                H    1.883202   -1.365266    1.732533
        ''',
        basis={'default':'def2tzvp','C':'6-31G*','H':'6-31G*'}, symmetry=0 ,spin = 4,charge = 0,verbose= 4)

title = 'FeCpPy'
mf = scf.rohf.ROHF(mol).x2c()
mf.chkfile = title+'_rohf.chk'
mf.init_guess = 'chk'
mf.level_shift = .2
mf.max_cycle = 1
mf.kernel()

mydmet = ssdmet.SSDMET(mf,title=title)

mydmet.kernel(mol.search_ao_label('Fe *'),imp_solver='casscf',imp_solver_soc='siso',statelis=[0,0,45,0,5])